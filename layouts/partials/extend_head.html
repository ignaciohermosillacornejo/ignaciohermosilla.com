<script>
(function() {
  if (localStorage.getItem('lang-preference')) return;
  var lang = navigator.language || navigator.userLanguage || '';
  if (lang.startsWith('es') && window.location.pathname.startsWith('/en/')) {
    localStorage.setItem('lang-preference', 'es');
    window.location.replace(window.location.pathname.replace(/^\/en\//, '/es/'));
  } else {
    localStorage.setItem('lang-preference', 'en');
  }
})();
</script>
<script>
document.addEventListener('DOMContentLoaded', function() {
  document.querySelectorAll('.lang-switch a').forEach(function(link) {
    link.addEventListener('click', function() {
      var href = this.getAttribute('href');
      localStorage.setItem('lang-preference', href.startsWith('/es') ? 'es' : 'en');
    });
  });
});
</script>
